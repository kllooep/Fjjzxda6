local splib = loadstring(game:HttpGet("https://raw.githubusercontent.com/as6cd0/SP_Hub/refs/heads/main/splibv2"))()

local Window = splib:MakeWindow({
 Name = "NetroZ  Hub",
 SubTitle = "By Rami",
 HidePremium = false,
 SaveConfig = true,
 Setting = true,
 RainbowMainFrame = false,
 RainbowTitle = false,
 RainbowSubTitle = false,
 ToggleIcon = "rbxassetid://76309561927185",
 ConfigFolder = "SP_Library",
 CloseCallback = true
})

local ChildTab = Window:MakeTab({
    Name = "زعاطيط",
    Icon = "rbxassetid://83114982417764"
})

-- ==================== القسم ====================
ChildTab:AddSection({
    Name = "زعطوط"
})

ChildTab:AddParagraph("معلومة:", "هنا تدز زعاطيط للناس.")

-- === الخدمات ===
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- === المتغيرات ===
local chasingplayer = nil
local playerChild = nil

-- === دالة منقولة من FreezTab لتحديث قائمة اللاعبين ===
local function getPlayerList()
    local playerNames = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(playerNames, player.Name)
        end
    end
    table.sort(playerNames)
    return playerNames
end

-- === Dropdown لاختيار اللاعب ===
playerChild = ChildTab:AddDropdown({
    Name = "اختار لاعب تدز له زعطوط",
    Options = getPlayerList(), -- تعبئة أولية
    Default = "",
    Callback = function(selected)
        if Players:FindFirstChild(selected) then
            chasingplayer = selected
        else
            chasingplayer = nil
        end
    end
})

-- === زر تحديث قائمة اللاعبين (مُحدث من FreezTab) ===
ChildTab:AddButton({
    Name = "تحديث قائمة اللاعبين",
    Callback = function()
        local newPlayers = getPlayerList()

        -- تحديث القائمة
        pcall(function()
            playerChild:Refresh(newPlayers, true) -- true = اختيار أول عنصر (اختياري)
        end)

        -- إذا غادر اللاعب المُختار
        if chasingplayer and not Players:FindFirstChild(chasingplayer) then
            chasingplayer = nil
            pcall(function()
                playerChild:Set("") -- إزالة الاختيار
            end)
        end
    end
})

-- === حدث: لاعب جديد انضم ===
Players.PlayerAdded:Connect(function(player)
    task.wait(0.1) -- تأخير بسيط للتأكد من تحميل اللاعب
    local updatedPlayers = getPlayerList()
    pcall(function()
        if playerChild then
            playerChild:Refresh(updatedPlayers, true)
        end
    end)
end)

-- === حدث: لاعب غادر ===
Players.PlayerRemoving:Connect(function(player)
    task.wait(0.1)
    local updatedPlayers = getPlayerList()
    pcall(function()
        if playerChild then
            playerChild:Refresh(updatedPlayers, true)
        end
    end)
    if chasingplayer == player.Name then
        chasingplayer = nil
        pcall(function()
            playerChild:Set("")
        end)
    end
end)

-- === زر: إرسال الطفل للشخص ===
ChildTab:AddButton({
    Name = "ارسال الطفل للشخص",
    Callback = function()
        if not chasingplayer then
            warn("لم يتم اختيار لاعب!")
            return
        end

        local target = Players:FindFirstChild(chasingplayer)
        if not target then
            warn("اللاعب غير موجود!")
            return
        end

        -- إرسال الطفل
        local args_spawn = {
            [1] = "CharacterFollowSpawnPlayer",
            [2] = "BabyBoy"
        }
        local Remote = ReplicatedStorage:FindFirstChild("RE"):FindFirstChild("1Bab1yFollo1w")
        if not Remote then
            warn("الريموت 1Bab1yFollo1w غير موجود!")
            return
        end

        pcall(function()
            Remote:FireServer(unpack(args_spawn))
        end)

        task.wait(0.2)

        -- تمكين التصادم
        if workspace:FindFirstChild(LocalPlayer.Name) then
            for _, part in pairs(workspace[LocalPlayer.Name]:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end

        -- ربط الطفل باللاعب المختار
        if workspace:FindFirstChild(LocalPlayer.Name) and workspace[LocalPlayer.Name]:FindFirstChild("FollowCharacter") then
            workspace[LocalPlayer.Name].FollowCharacter.Parent = workspace[target.Name]

            -- حركة الطفل خلف اللاعب
            if not getgenv().FollowLoop then
                getgenv().FollowLoop = RunService.Heartbeat:Connect(function()
                    local followChar = workspace:FindFirstChild(target.Name):FindFirstChild("FollowCharacter")
                    local targetHRP = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                    if followChar and followChar:FindFirstChild("Torso") and targetHRP then
                        local bodyPos = followChar.Torso:FindFirstChild("BodyPosition") or Instance.new("BodyPosition")
                        bodyPos.Position = targetHRP.Position - targetHRP.CFrame.LookVector * 3
                        bodyPos.MaxForce = Vector3.new(4000, 4000, 4000)
                        bodyPos.Parent = followChar.Torso

                        local bodyGyro = followChar.Torso:FindFirstChild("BodyGyro") or Instance.new("BodyGyro")
                        bodyGyro.CFrame = targetHRP.CFrame
                        bodyGyro.P = 15000
                        bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000)
                        bodyGyro.Parent = followChar.Torso
                    end
                end)
            end
        end
    end
})

-- === زر: رسبون الطفل ===
ChildTab:AddButton({
    Name = "رسبون الطفل (لازم بالبداية تضغط هذي)",
    Callback = function()
        -- إيقاف الحلقة السابقة
        if getgenv().FollowLoop then
            getgenv().FollowLoop:Disconnect()
            getgenv().FollowLoop = nil
        end

        -- حذف الطفل
        local args_delete = { [1] = "DeleteFollowCharacter" }
        local Remote = ReplicatedStorage:FindFirstChild("RE"):FindFirstChild("1Bab1yFollo1w")
        if Remote then
            pcall(function()
                Remote:FireServer(unpack(args_delete))
            end)
        end

        task.wait(0.5)

        -- إعادة إرسال الطفل
        local args_spawn = { [1] = "CharacterFollowSpawnPlayer", [2] = "BabyBoy" }
        if Remote then
            pcall(function()
                Remote:FireServer(unpack(args_spawn))
            end)
        end
    end
})

-- === تبديل: تجسس على اللاعب ===
ChildTab:AddToggle({
    Name = "تجسس على اللاعب الذي تم ارسال له طفل",
    Default = false,
    Callback = function(Value)
        if Value then
            if not chasingplayer then
                ChildTab:AddNotification({
                    Name = "خطأ",
                    Content = "لم يتم اختيار لاعب!",
                    Time = 5
                })
                return
            end

            if not getgenv().CameraConnection then
                getgenv().CameraConnection = RunService.RenderStepped:Connect(function()
                    local target = Players:FindFirstChild(chasingplayer)
                    if target and target.Character and target.Character:FindFirstChild("Humanoid") then
                        Camera.CameraSubject = target.Character.Humanoid
                    else
                        if getgenv().CameraConnection then
                            getgenv().CameraConnection:Disconnect()
                            getgenv().CameraConnection = nil
                        end
                        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                            Camera.CameraSubject = LocalPlayer.Character.Humanoid
                        end
                    end
                end)
            end
        else
            if getgenv().CameraConnection then
                getgenv().CameraConnection:Disconnect()
                getgenv().CameraConnection = nil
            end
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                Camera.CameraSubject = LocalPlayer.Character.Humanoid
            end
        end
    end
})

