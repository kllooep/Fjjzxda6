local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local distanceX, distanceZ = 1, 1


local ScreenGui = Instance.new("ScreenGui", PlayerGui)
ScreenGui.Name = "MourdFlingBringGui"
ScreenGui.ResetOnSpawn = false


local ToggleButton = Instance.new("TextButton", ScreenGui)
ToggleButton.Size = UDim2.new(0, 30, 0, 30)
ToggleButton.Position = UDim2.new(0, 10, 0, 10)
ToggleButton.BackgroundColor3 = Color3.fromRGB(180, 100, 255)
ToggleButton.Text = "+"
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.TextSize = 20
ToggleButton.Active = true
ToggleButton.Draggable = true
Instance.new("UICorner", ToggleButton).CornerRadius = UDim.new(1, 0)


local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 260, 0, 300)
MainFrame.Position = UDim2.new(0.5, -130, 0.5, -150)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(100, 0, 180)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)


local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Text = "Auto Fling / Target All"
Title.Font = Enum.Font.GothamBold
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1
Title.TextSize = 20


local Credits = Instance.new("TextLabel", MainFrame)
Credits.Size = UDim2.new(1, 0, 0, 20)
Credits.Position = UDim2.new(0, 0, 1, -20)
Credits.Text = "by mourd1123"
Credits.Font = Enum.Font.Gotham
Credits.TextColor3 = Color3.fromRGB(200, 200, 200)
Credits.BackgroundTransparency = 1
Credits.TextSize = 14


local NameBox = Instance.new("TextBox", MainFrame)
NameBox.PlaceholderText = "Enter Player Name"
NameBox.Size = UDim2.new(0.9, 0, 0, 30)
NameBox.Position = UDim2.new(0.05, 0, 0, 40)
NameBox.Font = Enum.Font.Gotham
NameBox.TextColor3 = Color3.fromRGB(0, 0, 0)
NameBox.BackgroundColor3 = Color3.fromRGB(230, 230, 230)
NameBox.TextSize = 16
Instance.new("UICorner", NameBox).CornerRadius = UDim.new(0, 8)


local DistanceXBox = Instance.new("TextBox", MainFrame)
DistanceXBox.PlaceholderText = "X Distance"
DistanceXBox.Size = UDim2.new(0.42, 0, 0, 25)
DistanceXBox.Position = UDim2.new(0.05, 0, 0, 75)
DistanceXBox.Font = Enum.Font.Gotham
DistanceXBox.TextColor3 = Color3.fromRGB(0, 0, 0)
DistanceXBox.BackgroundColor3 = Color3.fromRGB(240, 240, 240)
DistanceXBox.TextSize = 14
Instance.new("UICorner", DistanceXBox).CornerRadius = UDim.new(0, 6)


local DistanceZBox = Instance.new("TextBox", MainFrame)
DistanceZBox.PlaceholderText = "Z Distance"
DistanceZBox.Size = UDim2.new(0.42, 0, 0, 25)
DistanceZBox.Position = UDim2.new(0.53, 0, 0, 75)
DistanceZBox.Font = Enum.Font.Gotham
DistanceZBox.TextColor3 = Color3.fromRGB(0, 0, 0)
DistanceZBox.BackgroundColor3 = Color3.fromRGB(240, 240, 240)
DistanceZBox.TextSize = 14
Instance.new("UICorner", DistanceZBox).CornerRadius = UDim.new(0, 6)

local SetDistButton = Instance.new("TextButton", MainFrame)
SetDistButton.Text = "تعيين المسافة"
SetDistButton.Size = UDim2.new(0.43, 0, 0, 25)
SetDistButton.Position = UDim2.new(0.05, 0, 0, 105)
SetDistButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
SetDistButton.TextColor3 = Color3.new(1, 1, 1)
SetDistButton.Font = Enum.Font.GothamBold
SetDistButton.TextSize = 14
Instance.new("UICorner", SetDistButton).CornerRadius = UDim.new(0, 6)


local ResetDistButton = Instance.new("TextButton", MainFrame)
ResetDistButton.Text = "إعادة تعيين"
ResetDistButton.Size = UDim2.new(0.43, 0, 0, 25)
ResetDistButton.Position = UDim2.new(0.53, 0, 0, 105)
ResetDistButton.BackgroundColor3 = Color3.fromRGB(255, 120, 0)
ResetDistButton.TextColor3 = Color3.new(1, 1, 1)
ResetDistButton.Font = Enum.Font.GothamBold
ResetDistButton.TextSize = 14
Instance.new("UICorner", ResetDistButton).CornerRadius = UDim.new(0, 6)


local AutoFlingButton = Instance.new("TextButton", MainFrame)
AutoFlingButton.Text = "Auto Fling"
AutoFlingButton.Size = UDim2.new(0.9, 0, 0, 35)
AutoFlingButton.Position = UDim2.new(0.05, 0, 0, 140)
AutoFlingButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
AutoFlingButton.TextColor3 = Color3.new(1, 1, 1)
AutoFlingButton.Font = Enum.Font.GothamBold
AutoFlingButton.TextSize = 18
Instance.new("UICorner", AutoFlingButton).CornerRadius = UDim.new(0, 8)


local StopButton = Instance.new("TextButton", MainFrame)
StopButton.Text = "Stop"
StopButton.Size = UDim2.new(0.9, 0, 0, 30)
StopButton.Position = UDim2.new(0.05, 0, 0, 180)
StopButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
StopButton.TextColor3 = Color3.new(1, 1, 1)
StopButton.Font = Enum.Font.GothamBold
StopButton.TextSize = 18
Instance.new("UICorner", StopButton).CornerRadius = UDim.new(0, 8)


local TargetAllButton = Instance.new("TextButton", MainFrame)
TargetAllButton.Text = "Target All"
TargetAllButton.Size = UDim2.new(0.9, 0, 0, 35)
TargetAllButton.Position = UDim2.new(0.05, 0, 0, 220)
TargetAllButton.BackgroundColor3 = Color3.fromRGB(0, 120, 0)
TargetAllButton.TextColor3 = Color3.new(1, 1, 1)
TargetAllButton.Font = Enum.Font.GothamBold
TargetAllButton.TextSize = 18
Instance.new("UICorner", TargetAllButton).CornerRadius = UDim.new(0, 8)


local StopTargetAllButton = Instance.new("TextButton", MainFrame)
StopTargetAllButton.Text = "Stop Target All"
StopTargetAllButton.Size = UDim2.new(0.9, 0, 0, 30)
StopTargetAllButton.Position = UDim2.new(0.05, 0, 0, 260)
StopTargetAllButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
StopTargetAllButton.TextColor3 = Color3.new(1, 1, 1)
StopTargetAllButton.Font = Enum.Font.GothamBold
StopTargetAllButton.TextSize = 18
Instance.new("UICorner", StopTargetAllButton).CornerRadius = UDim.new(0, 8)


ToggleButton.MouseButton1Click:Connect(function()
	MainFrame.Visible = not MainFrame.Visible
end)


local CloseButton = Instance.new("TextButton", ScreenGui)
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Position = UDim2.new(1, -30, 0, 5)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 16
Instance.new("UICorner", CloseButton).CornerRadius = UDim.new(1, 0)

CloseButton.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
end)


local function findPlayerByPartialName(partial)
	partial = partial:lower()
	for _, plr in pairs(Players:GetPlayers()) do
		if plr.Name:lower():find(partial) then
			return plr
		end
	end
end

local flingActive = false
local targetAllActive = false
local savedCFrame


SetDistButton.MouseButton1Click:Connect(function()
	local x = tonumber(DistanceXBox.Text)
	local z = tonumber(DistanceZBox.Text)
	if x and z then
		distanceX = x
		distanceZ = z
	end
end)


ResetDistButton.MouseButton1Click:Connect(function()
	distanceX = 1
	distanceZ = 1
	DistanceXBox.Text = ""
	DistanceZBox.Text = ""
end)


AutoFlingButton.MouseButton1Click:Connect(function()
	local plr = findPlayerByPartialName(NameBox.Text)
	if not plr then return end
	local character = LocalPlayer.Character
	local root = character and character:FindFirstChild("HumanoidRootPart")
	local hum = character and character:FindFirstChildOfClass("Humanoid")
	if not root or not hum then return end

	savedCFrame = root.CFrame
	flingActive = true
	targetAllActive = false

	local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
	if tool then tool.Parent = character end

	local bv = Instance.new("BodyVelocity")
	bv.Name = "FlingForce"
	bv.Velocity = Vector3.new(1e9, 1e9, 1e9)
	bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
	bv.Parent = root

	hum:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
	hum.PlatformStand = false

	local angle = 0
	task.spawn(function()
		while flingActive do
			local target = findPlayerByPartialName(NameBox.Text)
			if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
				local tRoot = target.Character.HumanoidRootPart
				local tHum = target.Character:FindFirstChildOfClass("Humanoid")
				if tHum then workspace.CurrentCamera.CameraSubject = tHum end
				angle += 50
				root.CFrame = tRoot.CFrame * CFrame.new(distanceX, 1.5, distanceZ) * CFrame.Angles(math.rad(angle), 0, 0)
				root.Velocity = Vector3.new(1e9, 1e9, 1e9)
				root.RotVelocity = Vector3.new(1e9, 1e9, 1e9)
			end
			task.wait()
		end
		local bv = root:FindFirstChild("FlingForce")
		if bv then bv:Destroy() end
		hum:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
		hum.PlatformStand = false
		workspace.CurrentCamera.CameraSubject = hum
	end)
end)


StopButton.MouseButton1Click:Connect(function()
	flingActive = false
	targetAllActive = false

	local char = LocalPlayer.Character
	if not char then return end
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end


	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character then
			for _, myPart in pairs(char:GetDescendants()) do
				if myPart:IsA("BasePart") then
					for _, otherPart in pairs(player.Character:GetDescendants()) do
						if otherPart:IsA("BasePart") then
							pcall(function()
								local noCollide = Instance.new("NoCollisionConstraint")
								noCollide.Part0 = myPart
								noCollide.Part1 = otherPart
								noCollide.Parent = myPart
							end)
						end
					end
				end
			end
		end
	end

	local connection
	connection = RunService.Stepped:Connect(function()
		pcall(function()
			hrp.Velocity = Vector3.zero
			hrp.RotVelocity = Vector3.zero
			hrp.AssemblyAngularVelocity = Vector3.zero
			hrp.AssemblyLinearVelocity = Vector3.zero
		end)
	end)

	task.delay(0.5, function()
		if savedCFrame and hrp then
			hrp.CFrame = savedCFrame
		end
	end)

	task.delay(3, function()
		if connection then
			connection:Disconnect()
		end
	end)
end)


TargetAllButton.MouseButton1Click:Connect(function()
	if targetAllActive then return end -- لمنع التشغيل المتكرر

	targetAllActive = true
	flingActive = false

	local playersList = {}
	for _, plr in pairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer then
			table.insert(playersList, plr)
		end
	end

	local character = LocalPlayer.Character
	local root = character and character:FindFirstChild("HumanoidRootPart")
	local hum = character and character:FindFirstChildOfClass("Humanoid")
	if not root or not hum then
		targetAllActive = false
		return
	end

	savedCFrame = root.CFrame

	local tool = LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
	if tool then tool.Parent = character end

	local bv = Instance.new("BodyVelocity")
	bv.Name = "FlingForce"
	bv.Velocity = Vector3.new(1e9, 1e9, 1e9)
	bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
	bv.Parent = root

	hum:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
	hum.PlatformStand = false

	local angle = 0

	task.spawn(function()
		local index = 1
		while targetAllActive and #playersList > 0 do
			local target = playersList[index]
			if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
				local tRoot = target.Character.HumanoidRootPart
				local tHum = target.Character:FindFirstChildOfClass("Humanoid")
				if tHum then workspace.CurrentCamera.CameraSubject = tHum end

				
				local startTime = os.clock()
				while targetAllActive and os.clock() - startTime < 4 do angle += 50
					root.CFrame = tRoot.CFrame * CFrame.new(distanceX, 1.5, distanceZ) * CFrame.Angles(math.rad(angle), 0, 0)
					root.Velocity = Vector3.new(1e9, 1e9, 1e9)
					root.RotVelocity = Vector3.new(1e9, 1e9, 1e9)
					task.wait()
				end
			end

			index += 1
			if index > #playersList then
				index = 1
			end
		end

		-- تنظيف عند الإيقاف
		local bv = root:FindFirstChild("FlingForce")
		if bv then bv:Destroy() end
		hum:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
		hum.PlatformStand = false
		workspace.CurrentCamera.CameraSubject = hum

		if savedCFrame and root then
			root.CFrame = savedCFrame
		end
	end)
end)


StopTargetAllButton.MouseButton1Click:Connect(function()
	targetAllActive = false

	local char = LocalPlayer.Character
	if not char then return end
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	
	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character then
			for _, myPart in pairs(char:GetDescendants()) do
				if myPart:IsA("BasePart") then
					for _, otherPart in pairs(player.Character:GetDescendants()) do
						if otherPart:IsA("BasePart") then
							pcall(function()
								local noCollide = Instance.new("NoCollisionConstraint")
								noCollide.Part0 = myPart
								noCollide.Part1 = otherPart
								noCollide.Parent = myPart
							end)
						end
					end
				end
			end
		end
	end

	local connection
	connection = RunService.Stepped:Connect(function()
		pcall(function()
			hrp.Velocity = Vector3.zero
			hrp.RotVelocity = Vector3.zero
			hrp.AssemblyAngularVelocity = Vector3.zero
			hrp.AssemblyLinearVelocity = Vector3.zero
		end)
	end)

	task.delay(0.5, function()
		if savedCFrame and hrp then
			hrp.CFrame = savedCFrame
		end
	end)

	task.delay(3, function()
		if connection then
			connection:Disconnect()
		end
	end)
end)